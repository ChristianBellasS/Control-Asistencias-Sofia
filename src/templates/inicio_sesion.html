<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inicio de Sesión - Control de Asistencia</title>

  <!-- Bootstrap y otros estilos -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/inicio_sesion.css') }}" />
</head>

<body>
  <div class="overlay d-flex justify-content-center align-items-center">
    <div class="modal-content shadow-lg" id="login-container">
      <!-- LOGIN con imagen -->
      <div class="row g-0 w-100" id="login-form">
        <div class="col-md-6 d-none d-md-block" id="login-image">
          <img src="{{ url_for('static', filename='images/foto.jpg') }}" class="img-fluid h-100" alt="Imagen de inicio de sesión" />
        </div>
        <div class="col-md-6 p-3 d-flex align-items-center">
          <div class="w-100" id="form-wrapper">
            <div class="tabs-wrapper mb-4 text-center">
              <div class="switch-tabs d-inline-flex">
                <span id="btn-login" class="tab active-tab">Iniciar sesión</span>
                <span id="btn-register" class="tab">Registrarse</span>
              </div>
            </div>
            <h2 class="text-center mb-3">Inicio de sesión</h2>
            <form action="{{ url_for('login.procesar_login') }}" method="post" id="loginForm">
              <div class="form-floating mb-3 position-relative">
                <i class="fas fa-user icon-input"></i>
                <input type="text" class="form-control ps-5" name="username" placeholder="Usuario" autocomplete="off" required />
                <label for="username">Usuario</label>
              </div>
              <div class="form-floating mb-3 position-relative">
                <i class="fas fa-lock icon-input"></i>
                <input type="password" class="form-control ps-5" name="password" placeholder="Contraseña" required />
                <label for="password">Contraseña</label>
              </div>
              <div class="d-grid gap-2">
                <button type="submit" class="btn btn-success btn-lg">
                  <i class="fas fa-sign-in-alt"></i> Iniciar sesión
                </button>
              </div>
            </form>
            <div class="text-center mt-4">
              <a href="#" class="text-muted" data-bs-toggle="modal" data-bs-target="#modalRecuperarClave">¿Olvidaste tu contraseña?</a>
            </div>
          </div>
        </div>
      </div>

      <!-- REGISTRO -->
      <div class="p-5 w-100" id="register-form">
        <div class="w-100" id="form-wrapper">
          <div class="tabs-wrapper mb-4 text-center">
            <div class="switch-tabs d-inline-flex">
              <span id="btn-login-2" class="tab">Iniciar sesión</span>
              <span id="btn-register-2" class="tab active-tab">Registrarse</span>
            </div>
          </div>
          <h2 class="text-center mb-3">Registro de usuario</h2>
          <form id="registerForm" action="{{ url_for('usuario.registro_usuario') }}" method="post" enctype="multipart/form-data">
            <div class="text-center mb-4">
              <img id="foto-preview" class="rounded-circle shadow" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Foto de perfil" />
              <div class="mt-2">
                <button type="button" class="btn btn-outline-primary btn-sm" onclick="document.getElementById('foto-input').click();">
                  <i class="fas fa-upload"></i> Subir foto
                </button>
                <input type="file" name="foto" id="foto-input" style="display: none;" accept="image/*" />
              </div>
            </div>
            <div class="row g-3">
              <div class="col-md-6">
                <div class="form-floating position-relative">
                  <i class="fas fa-id-card icon-input"></i>
                  <input type="text" class="form-control ps-5" name="dni" placeholder="DNI" maxlength="8" required tabindex="1" id="dni-input" inputmode="numeric" pattern="\d*" />
                  <label>DNI</label>
                </div>
                <div class="form-floating position-relative mt-3">
                  <i class="fas fa-user-tag icon-input"></i>
                  <input type="text" class="form-control ps-5" name="apellido_paterno" placeholder="Apellido Paterno" required tabindex="3" maxlength="80" id="apellido-paterno-input" />
                  <label>Apellido paterno</label>
                </div>
                <div class="form-floating position-relative mt-3">
                  <i class="fas fa-phone icon-input"></i>
                  <input type="text" class="form-control ps-5" name="telefono" placeholder="Teléfono" required tabindex="5" maxlength="9" inputmode="numeric" id="telefono-input" />
                  <label>Teléfono</label>
                </div>
                <div class="form-floating position-relative mt-3">
                  <i class="fas fa-lock icon-input"></i>
                  <input type="password" class="form-control ps-5" name="contrasena" placeholder="Contraseña" required tabindex="7" />
                  <label>Contraseña</label>
                </div>
                <div class="form-floating position-relative">
                  <i class="fas fa-envelope icon-input"></i>
                  <input type="email" class="form-control ps-5" name="correo_electronico" placeholder="Correo Electrónico" required tabindex="9" />
                  <label>Correo electrónico</label>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-floating position-relative">
                  <i class="fas fa-id-card icon-input"></i>
                  <input type="text" class="form-control ps-5" name="nombres" placeholder="Nombres" required tabindex="2" maxlength="80" id="nombres-input" />
                  <label>Nombres</label>
                </div>
                <div class="form-floating position-relative mt-3">
                  <i class="fas fa-user-tag icon-input"></i>
                  <input type="text" class="form-control ps-5" name="apellido_materno" placeholder="Apellido Materno" required tabindex="4" maxlength="80" id="apellido-materno-input" />
                  <label>Apellido materno</label>
                </div>
                <div class="form-floating position-relative mt-3">
                  <i class="fas fa-user icon-input"></i>
                  <input type="text" class="form-control ps-5" name="usuario" placeholder="Usuario" required tabindex="6" />
                  <label>Usuario</label>
                </div>
                <div class="form-floating position-relative mt-3">
                  <i class="fas fa-lock icon-input"></i>
                  <input type="password" class="form-control ps-5" name="confirmarcontrasena" placeholder="Confirmar Contraseña" required tabindex="80" />
                  <label>Validar contraseña</label>
                </div>
                <div class="form-floating position-relative mt-3">
                  <i class="fas fa-user-shield icon-input"></i>
                  <select class="form-control ps-5" name="rol" required tabindex="10">
                    {% for rol in roles %}
                    <option value="{{ rol.rol_id }}">{{ rol.nombre }}</option>
                    {% endfor %}
                  </select>
                  <label for="rol">Rol</label>
                </div>
              </div>
            </div>
            <div class="gap-2 mt-3 text-center">
              <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-user-plus"></i> Registrar usuario
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Recuperar Contraseña -->
  <div class="modal fade" id="modalRecuperarClave" tabindex="-1" aria-labelledby="modalRecuperarClaveLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content animate__animated animate__fadeInDown">
        <h5 class="modal-title mb-4" id="modalRecuperarClaveLabel">
          <i class="fas fa-unlock-alt me-2"></i> Recuperar Contraseña
        </h5>
        <!-- Paso 1: Validar usuario y palabra clave -->
        <div id="paso1">
          <div class="mb-3">
            <label for="recuperarUsuario" class="form-label"><i class="fas fa-user me-2"></i> Usuario</label>
            <input type="text" id="recuperarUsuario" class="form-control" autocomplete="off" placeholder="Tu usuario" />
          </div>
          <div class="mb-3">
            <label for="recuperarPalabraClave" class="form-label"><i class="fas fa-key me-2"></i> Palabra clave</label>
            <input type="text" id="recuperarPalabraClave" class="form-control" autocomplete="off" placeholder="Palabra clave secreta" />
          </div>
          <button id="btnValidarClave" class="btn btn-primary w-100"><i class="fas fa-check-circle me-2"></i> Validar</button>
        </div>
        <!-- Paso 2: Cambiar contraseña (oculto inicialmente) -->
        <div id="paso2" style="display:none;">
          <div class="mb-3">
            <label for="nuevaContrasena" class="form-label"><i class="fas fa-lock me-2"></i> Nueva contraseña</label>
            <input type="password" id="nuevaContrasena" class="form-control" placeholder="Nueva contraseña" />
          </div>
          <div class="mb-3">
            <label for="confirmarNuevaContrasena" class="form-label"><i class="fas fa-lock me-2"></i> Confirmar nueva contraseña</label>
            <input type="password" id="confirmarNuevaContrasena" class="form-control" placeholder="Repite la nueva contraseña" />
          </div>
          <button id="btnCambiarContrasena" class="btn btn-success w-100"><i class="fas fa-key me-2"></i> Cambiar contraseña</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts de Bootstrap y otros -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="../static/js/inicio_sesion.js" defer></script>

</body>

</html>
